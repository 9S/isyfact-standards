h2. *Anforderungen*
h3. A1: Es darf keine Redundanzen oder Widersprüche bzgl. den Vorgaben zu REST zwischen den Bausteinen REST und SGW geben.

Der Baustein REST beschreibt die Verwendung von REST-Services zur internen (d.h. innerhalb einer AWL) Kommunikation. SGWs wiederum bieten REST-Services zur externen Kommunikation an. Dazu gibt es im Baustein SGW ein Dokument "Konzept_REST-Webservices".

Dieses Dokument muss nach Abschluss des Tickets IFS-606 gegen das REST-Konzept gehalten werden. Redudanzen sollen durch Verweise des SGW-Dokuments auf das REST-Konzept aufgelöst werden. Widersprüche müssen in der Ticketbeschreibung gesammelt und entweder in diesem Ticket oder in Folgetickets aufgelöst werden.
h4. Abnahmekriterien
* Es gibt keine redundanten Inhalte mehr zwischen den Dokumenten "Konzept_REST-Webservices" des Bausteins SGW und "Konzept REST" des Bausteins REST.
* Identifizierte Widersprüche sind in untenstehender Tabelle dokumentiert.
* Für alle nicht aufgelösten Widersprüche gibt es Folgetickets.

{quote}(i) Möglicherweise könnte das Konzept_Rest_Webservices aus der RF (BS SGW) komplett zugunsten des neuen REST-Konzepts entfallen. Dazu müsste geklärt werden ob die Differenzierung zwischen Ressourcen und Nachrichten wirklich benötigt wird, ob externe Schnittstellen nicht auch besser oAuth 2.0 verwenden anstelle von Basic Auth (dringend empfohlen) und ob neue SGWs nicht auch mit Spring MVC/Webflux umgesetzt werden können.
{quote}
 
h2. *Ergebnis: Dokumentenabgleich*

 

In der folgenden Tabelle wird das Ergebnis des Dokumentenabgleichs zwischen dem REST-Konzept für die interne Dokumentation und dem REST-Konzept für die externe Kommunikation aufgelistet.  Basis sind die im Ticketanhang hochgeladenen (mit Kommentaren versehenen) Dokumente. 

Der Abgleich findet anhand der jeweiligen Dokumentenkapitel statt (Spalte 1 + Sparte 2). In der dritten Spalte wird der Inhalt der Kapitel kommentiert, Widersprüche aufgezeigt und Verfahrensvorschläge gemacht. 

 
|{color:#0747a6}*Rest Konzept (insbes.* {color}
{color:#0747a6} *interne Kommunikation)*{color}|{color:#0747a6}*Rest Konzept (insbes.* {color}
{color:#0747a6} *externe Kommunikation)*{color}|{color:#0747a6}*Kommentare, Widersprüche, Verfahrensvorschläge*{color}|
| | | |
|1. Einleitung|1. Einleitung|*Formulierung überarbeiten*
Bei Zusammenführung anpassen (Kapitelbeschreibung, Zielgruppe)|
|2. Grundlagen|2. Anforderungen und Vorgaben
2.1. Grundlagen|*Redundanzen bearbeiten*
REST wird mit verschiedenen Grafiken, Terminologie und Definitionen beschrieben.
--> Vereinheitlichung der Terminologie
 
*Unterschiede*
Im Konzept für externe Kommunikation dürfen Ressourcen auch Nachrichten sein
--> Vorschlag: als Spezialisierung übernehmen ins interne Konzept|
|3. Eigenschaften von REST Schnittstellen| | |
|3.1 Aufbau der Ressourcen-URIs| |*Empfehlungsformulierung!*
Empfehlung zur Nutzung von HATEOAS hier fehl am Platz;
Ferner darüber nachdenken, ob nicht die zuvor ergangene Empfehlung Rest mind. Stufe 2 besser ist.
(siehe kommentiertes internes REST-Dokument)|
|3.1 Aufbau der Ressourcen-URIs|2.3. Adressierbarkeit
2.3.1. Ressource ist fachliche Entität
2.3.2. Ressource ist Nachricht|*Widersprüche*
Bei den Vorgaben des (externen) und den Vorgaben des (internen) REST Konzepte gibt es Widersprüche sowohl zwischen den Dokumenten als auch innerhalb der Dokumente (s.a. kommentierte Dokumente, Aufbau der Ressourcen-URIs)
 *Spezialität*
** Die Betrachtung einer Ressource als Nachricht ist eine Spezialität bei der externen Kommunikation.
*Vorschlag:*
*Aufnahme im SpezialKapitel für externe Kommunikation*
Spezielles Kapitel im REST Konzept, das die speziellen konzeptionellen Vorgaben bei externer Kommunikation enthält.
|3.1.1. Beziehungen zwischen Ressourcen| |*Formulierung (intern REST) überarbeiten*
(s.a. Dokumentenkommentare)|
|3.2. Idempotenz|2.4. Zustandslosigkeit|*Redundanz*
Redundanz auflösen, gemeinsame Terminologie|
|3.3. Verwendung von HTTP-Methoden|2.6. HTTP-Verben
2.6.1. Ressourcen sind Entitäten
2.6.2. Ressourcen sind Nachrichten|*Redundanz* |

* unterschiedl. Beschreibungen und Beispiele zusammenführen
* *Widersprüche*
* Betrachtung von Ressourcen als Nachricht auslagern
* Hinweis auf geringeren HTTP-Verben umfang auslagern (PATCH/HEAD/ OPTIONS)
* *Vorschlag* 
Neues Kapitel im REST Konzept, das die speziellen konzeptionellen Vorgaben bei externer Kommunikation enthält.**|
|3.4. Verwendung von HTTP-Statuscodes|2.7. HTTP-Statuscodes
2.7.1. Ressourcen sind Entitäten
2.7.2. Ressourcen sind Nachrichten|*Vereinheitlichung* 
 |

* Vereinheitlichung der zulässigen Statuscodes bei "Ressourcen sind Entitäten"
* *Vorschlag:*  Neues Kapitel im REST Konzept, das die speziellen konzeptionellen Vorgaben bei externer Kommunikation enthält. (hier Statuscodes bei Nachrichten)|
|3.5. Repräsentationen|2.5. Repräsentationen
2.5.1. Datenformat|*Formulierungen (intern REST) überarbeiten*
Text- oder binäre Ressourcen,
Exkurs zu externen REST,
Empfehlung für einheitlichen Repräsentationstyp (Datenaustauschformat)
 
*Widerspruch*
Das XML Datenformat als Pflicht ist eine Spezialität bei der externen Kommunikation.
*Vorschlag: Aufnahme im SpezialKapitel für externe Kommunikation*
 |
|3.5.1. Content Negotiation|2.5.2. Content Type|*Widerspruch*
Bei externer Kommunikation ist der zulässige Content Type  stark eingeschränkt.
 
*Vorschlag: Aufnahme im SpezialKapitel für externe Kommunikation*|
| |3.3.1 Suche und Filterung mittels POST||*Verbleib abklären*
In der Doku für externe Kommunikation findet sich ein Kapitel bzgl. Suche und Filterung.
 
Der Verbleib ist abzuklären. Denkbar wäre die Vorgabe für Suche und Filterung in dem Nutzungsvorgabendokument des REST-Bausteins aufzunehmen/abzugleichen.
--> Folgeticket\|||
|3.6. Metadaten|2.12. Metadaten|*Prüfung*
Kapitel im internen REST-Konzept könnte entfallen und bei HEAD im HTTP-Methoden Kapitel aufgenommen werden oder z.B ein interner Link auf das HTTP-Mehoden Kapitel
*Prüfung*
Der Inhalt des Metadaten Kapitels ist beim externen REST-Webservice Dokuments vollkommen anders ausgerichtet.
*Vorschlag: Aufnahme im SpezialKapitel für externe Kommunikation*|
|3.7. Caching| |*o.k. + Prüfung*
Prüfung, ob es mittlerweile Vorgaben bzw. einen ADR bzgl Caching bei REST-Webservices gibt|
|3.8. HATEOS| |*Vorschlag*
Kapitel wäre ggf. besser unter 3.1. Aufbau der Ressourcen-URIs als Unterkapitel 3.1.4 untergebracht|
|4. Festlegungen zur Umsetzung| | |
|4.1. Technologieauswahl| |*(vermeintlichen) Widerspruch auflösen*
 
Das interne REST-Konzept nennt Spring MVC/Webflux als Framework
*Vorschlag : so belassen (entspricht ADR-Entscheidung)*
 
Das externe REST-Konzept nennt Apache CXF als Framework 
 
*Vorschlag: Aufnahme im SpezialKapitel für externe Kommunikation*
 |
|4.2. Spring MVC im Vergleich zu Spring Webfux| |*o.k. + Vorschlag*
ungewöhnlich dass hier eine Begründung für die eine oder andere Technologie zu finden ist.
Vorschlag wäre: Kapitel 4.2. in Kapitel 4.1.1. „Einsatzszenarien Spring MVC und Spring Webflux“ umzubenennen, damit es mehr in Richtung geht, wann welche Technologie einzusetzen ist|
|4.3. Schnittstellendokumentation| |*o.k.*
auf dem aktuellen Beschluß-stand|
|4.3.1. Code Generierung| |*Überarbeitung (int. REST)*
auf dem aktuellen Beschluß-stand
ggf. Link auf Bausteindoku Nutzungsvorgaben (Doku ist in Erstellung) einfügen|
| |3. Realisierung
3.1. Service-Provider
3.1.1  …
…
3.1.6. Generierung eines Stubs|*Vorschlag: Aufnahme im SpezialKapitel für externe Kommunikation*
 ** |
|4.3.2. Bereitstellen von generierten Clients|3.2. Service-Consumer
3.2.1 Generierung des Client Codes|*Überarbeitung (int. REST)*
ggf. Link auf Bausteindoku Nutzungsvorgaben (Doku ist in Erstellung) einfügen
 
*Auslagerung (ext. REST)*
 ** 
*Vorschlag: Aufnahme im SpezialKapitel für externe Kommunikation*
 |
|4.4. Verwendung von Transportobjekten| |*Übernahme des Kapitels* aus dem intern. REST-Konzept|
|5. Querschnittliche Konzepte| | |
|5.1. Validierung von Anfragen| |*Übernahme des Kapitels* aus dem intern. REST-Konzept|
|5.2. Fehlerbehandlung
5.2.1. Entkopplung von Fehlerbehandlung und Service Logik
5.2.1. Einheitliche Fehlermeldungen|2.8. Fehlerhandling
2.8.1 Aufrufer-Fehler
2.8.2. Serverseitiger Fehler
2.8.3. XSD zur Übergabe strukturierter Fehlerinformationen|*Unterschiede feststellbar* |

* Das Kapitel zur Fehlerbehandlung im internen REST-Konzept befasst sich mehr mit allgem. Vorgaben zur Fehlerbehandlung.
* Das Kapitel zur Fehlerbehandlung im externen REST-Konzept befasst sich insbes. mit den diesbezüglichen Besonderheiten.
*Vorschlag:*  
**
*** Kapitel im internen REST-Konzept übernehmen
*** Neues Kapitel im REST Konzept, das die speziellen konzeptionellen Vorgaben bei externer Kommunikation enthält. (hier Unterpunkt: Fehlerhandling) |
|5.3. Sicherheit|2.11. Authentifizierung und Autorisierung||*Widerspruch -> Folgeticket*
Das externe REST-Konzept beschreibt Basic Auth
 
Im internen Konzept wird OAuth2 als Authentifizierungsmethode gesetzt
 
*--> Folgeticket zur einheitl. Vorgabe der Authenfizierung bei internen und externen REST-Webservices*
 
Mit RF-435 wird das Authentication Gateway konzipiert. Dieses löst automatisch die Basic Authentication ab. Sobald das Authentication Gateway ausgeliefert wurde, muss das Kapitel angepasst werden. Folgeticket muss angelegt werden.\|||
|5.4.1. Server / Service-Provider| |o.k.|
|5.4.2. Client / Service-Consumer| |o.k.|
|5.4.3. Inhalt des Log-Eintrags für eine Nachricht| |*Prüfung*
mit dem externen REST-Konzept abgleichen|
|5.5. Überwachung|Kein entsprechendes Kapitel| |
|5.6. Versionierung| ||*Widersprüche*
Bei beiden vorhandenen Konzepten wird nur die Majorrelease eingebaut (z.B. /v1/), aber die Vorgabe für den Aufbau des vorangehenden Pfads unterscheiden sich (z.B. /api/ vs /rest/)\|||
|Literaturverzeichnis
Abbildungsverzeichnis
Listenverzeichnis|Literaturverzeichnis
Abbildungsverzeichnis
Listenverzeichnis|*Entfällt*
(im Vorgriff auf eine Antora-Migration der Dokumente)|
| | | |
|Anhang A: Content Types|Keine Anhang im Dokument|*Tabelle ergänzen, bearbeiten*
Gängige Typen wie PNG oder SVG sind nicht aufgeführt, dafür aber das verlustbehaftete Typ JPG, den wir nicht verwenden sollten|
|Anhang B: HTTP-Methoden|Keine Anhang im Dokument|*o.k. + Prüfung*
mit dem externen REST-Konzept abgleichen
Plus Vorschlag: bei PATCH Beispiel einfügen, warum diese Methode Idempotent sein kann (s.a. Kommentar in der Doku)|
h2. *Dokumentation*

Dokumentation ist
[X] anzupassen
[ ] nicht anzupassen
h4. Konkrete Anpassungen
* Baustein SGW: Konzept_REST-Webservices
* Bautstein isy-rest: Internes REST-Konzept

h2. *Neue Bibliotheken und/oder Abweichungen vom Produktkatalog*

[ ] Es werden neue Bibliotheken verwendet
[ ] Es wird vom Produktkatalog abgewichen
[X] Es werden KEINE neuen Bibliotheken eingesetzt und es wird NICHT vom Produktkatalog abgewichen.